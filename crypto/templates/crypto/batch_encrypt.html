{% extends 'base.html' %}

{% block content %}
<h2>ğŸ“‹ ãƒãƒƒãƒæš—å·åŒ–ï¼ˆè¤‡æ•°ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ï¼‰</h2>

<div class="row">
    <div class="col-md-8">
        <form method="post">
            {% csrf_token %}
            <div class="mb-3">
                <label for="texts" class="form-label">æš—å·åŒ–ã—ãŸã„ãƒ†ã‚­ã‚¹ãƒˆï¼ˆæ”¹è¡ŒåŒºåˆ‡ã‚Šï¼‰</label>
                <textarea 
                    name="texts" 
                    id="texts" 
                    class="form-control" 
                    rows="8"
                    placeholder="è¤‡æ•°ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ”¹è¡Œã§åŒºåˆ‡ã£ã¦å…¥åŠ›ã—ã¦ãã ã•ã„&#10;ä¾‹ï¼š&#10;Hello World&#10;Good Morning&#10;Thank you"
                    required></textarea>
                <small class="form-text text-muted">
                    å„è¡ŒãŒå€‹åˆ¥ã«æš—å·åŒ–ã•ã‚Œã¾ã™ã€‚ç©ºè¡Œã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚
                </small>
            </div>
            
            <div class="mb-3">
                <label for="method" class="form-label">æš—å·åŒ–æ–¹å¼</label>
                <select name="method" id="method" class="form-select" required>
                    <option value="">æš—å·åŒ–æ–¹å¼ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                    {% for value, display in method_choices %}
                        <option value="{{ value }}">{{ display }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ -->
            <div class="mb-3">
                <div class="alert alert-info">
                    <span id="lineCount">0</span> è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™
                </div>
            </div>
            
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                    ğŸ” ä¸€æ‹¬æš—å·åŒ–ã™ã‚‹
                </button>
                <a href="{% url 'batch_decrypt' %}" class="btn btn-outline-secondary">
                    ğŸ”“ ãƒãƒƒãƒå¾©å·åŒ–ã¸
                </a>
                <a href="{% url 'encrypt' %}" class="btn btn-outline-dark">
                    â† é€šå¸¸ã®æš—å·åŒ–ã¸
                </a>
            </div>
        </form>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5>ğŸ’¡ ä½¿ã„æ–¹ã®ãƒ’ãƒ³ãƒˆ</h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    <li><strong>ğŸ“ å…¥åŠ›æ–¹æ³•</strong><br>
                        <small class="text-muted">å„è¡Œã«1ã¤ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›</small></li>
                    <li><strong>ğŸ”¢ å‡¦ç†ä»¶æ•°</strong><br>
                        <small class="text-muted">æœ€å¤§100è¡Œã¾ã§ä¸€åº¦ã«å‡¦ç†å¯èƒ½</small></li>
                    <li><strong>âš¡ é«˜é€Ÿå‡¦ç†</strong><br>
                        <small class="text-muted">å…¨ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¸€åº¦ã«æš—å·åŒ–</small></li>
                    <li><strong>ğŸ’¾ è‡ªå‹•ä¿å­˜</strong><br>
                        <small class="text-muted">çµæœã¯å±¥æ­´ã«è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™</small></li>
                    <li><strong>ğŸ“‹ çµæœå‡ºåŠ›</strong><br>
                        <small class="text-muted">çµæœã¯ä¸€è¦§è¡¨ç¤ºãƒ»ã‚³ãƒ”ãƒ¼å¯èƒ½</small></li>
                </ul>
                
                <hr>
                
                <h6>ğŸ¯ æ´»ç”¨ä¾‹</h6>
                <ul class="list-unstyled">
                    <li>â€¢ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¸€è¦§ã®æš—å·åŒ–</li>
                    <li>â€¢ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¹ãƒˆã®å‡¦ç†</li>
                    <li>â€¢ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é …ç›®ã®å¤‰æ›</li>
                    <li>â€¢ ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®ä¸€æ‹¬å‡¦ç†</li>
                </ul>
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h5>æš—å·åŒ–æ–¹å¼</h5>
            </div>
            <div class="card-body">
                <small class="text-muted">
                    ã™ã¹ã¦ã®è¡Œã«åŒã˜æš—å·åŒ–æ–¹å¼ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚<br>
                    è©³ç´°ã¯<a href="{% url 'encrypt' %}">é€šå¸¸ã®æš—å·åŒ–ãƒšãƒ¼ã‚¸</a>ã‚’ã”å‚ç…§ãã ã•ã„ã€‚
                </small>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const textsTextarea = document.getElementById('texts');
    const lineCountSpan = document.getElementById('lineCount');
    
    function updateLineCount() {
        const text = textsTextarea.value.trim();
        if (!text) {
            lineCountSpan.textContent = '0';
            return;
        }
        
        const lines = text.split('\n').filter(line => line.trim() !== '');
        lineCountSpan.textContent = lines.length;
        
        // 100è¡Œã‚’è¶…ãˆã‚‹å ´åˆã¯è­¦å‘Š
        if (lines.length > 100) {
            lineCountSpan.parentElement.className = 'alert alert-warning';
            lineCountSpan.parentElement.innerHTML = 
                `<strong>âš ï¸ ${lines.length} è¡Œ</strong> - 100è¡Œã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚å‡¦ç†ã«æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚`;
        } else if (lines.length > 50) {
            lineCountSpan.parentElement.className = 'alert alert-info';
            lineCountSpan.parentElement.innerHTML = 
                `<span id="lineCount">${lines.length}</span> è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™ï¼ˆå¤§é‡å‡¦ç†ï¼‰`;
        } else {
            lineCountSpan.parentElement.className = 'alert alert-info';
            lineCountSpan.parentElement.innerHTML = 
                `<span id="lineCount">${lines.length}</span> è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆãŒå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã™`;
        }
    }
    
    textsTextarea.addEventListener('input', updateLineCount);
    
    // åˆæœŸè¡¨ç¤º
    updateLineCount();
});
</script>
{% endblock %}
